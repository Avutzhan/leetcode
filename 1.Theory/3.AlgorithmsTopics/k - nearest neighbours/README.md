
### K nearest neighbours

алгоритм к ближайших соседей нужен для классификацит всяких штук

Принцип алгоритма

1. Вы получаете новый фрукт для классификации
2. Вы проверяете его 3 ближайших соседа 
3. Среди соседей апельсинов больше чем грейпфрутов
поэтому фрукт скорее всего является апельсином

Простой алгоритм для классификации всегда сначала пробуй его

Построение рекомендательной системы 

Пример рекомендация фильмов на высоком уровне эта задача похожа на
задачу с грейпфрутами

Извлечение признаков

В примере с грейпфрутами мы сравнивали цвет и кожуру - это признаки
Если есть фрукты то надо извлекать признаки

Формула пифагора 

для измерения расстояния между двумя точками. Это поможет
измерить степень схожести. Так как при нахождении ближайших 
соседей мы строим график и наносим данные в него по какому то признаку

⎷(x<sub>1</sub> - x<sub>2</sub>) + (y<sub>1</sub> - y<sub>2</sub>)

Пример 

⎷(2-2)<sup>2</sup> + (2-1)<sup>2</sup>

= ⎷0 + 1

= ⎷1

= 1

расстояние между А и Б = 1
типа они похожи

Чтобы с сделать так с Пользователями нужно их нанести на график
то есть каждого пользователя преобразуем в координаты

как преобразовать их в координаты? при регистрации предложите оценить несколько
категорий фильмов нравятся или нет. После этого появится набор оценок для каждого
пользователя

|         |Приянка | Джастин | Морфеус |
|:---:    |:---:   |:---:    |:---:    |
|комедия  |3       | 4       | 2       |
|боевик   |4       | 3       | 5       |
|драма    |4       | 5       | 1       |
|ужасы    |1       | 1       | 3       |
|мелодрама|4       | 5       | 1       |

Фрукт представлялся из набора двух чисел (2,2)
Пользователь из 5 (3,4,4,1,4)

Теперь вместо вычиления в 2 измерениях вы вычисляете в 5

Насколько близки между собой наборы жтих чисел передавай хоть сколько наборов

⎷(a<sub>1</sub> - a<sub>2</sub>) + (b<sub>1</sub> - b<sub>2</sub>) +
(c<sub>1</sub> - c<sub>2</sub>) + (d<sub>1</sub> - d<sub>2</sub>) +
(e<sub>1</sub> - e<sub>2</sub>)

⎷(3 - 4) + (4 - 3) + (4 - 5) + (1 - 1) + (4 - 5)

= ⎷1 + 1 + 1 + 0 + 1

= ⎷4

= 2

Это расстояние между Приянкой и Джастином

И так далее вычисляем рассояние между каждым и смотрим у кого меньше расстояние

Регрессия

Просто порекомендовать теперь не достаточно

Спрогнозируем какую оценку поставит Приянка

Возьмите 5 пользователей вблизи нее

К это ближайшие соседи можно взять сколько хочешь 5  10 или 10000

Угадываем какую оценку поставит Приянка вокруг нее пользователи поставили

Джастин 5
Джей си 4
Джозеф 4
Ланс 5
Крис 3

Среднее арифметическое будет =  4.2 такой метод прогнозирования является регрессией

* У алгоритма к ближайших соседей есть два основных применения 
  * Классификация распределение по категориям
  * и регрессия прогнозирование ответа
* Регрессия очень полезна

Задача с Булочной. Пытаемся предсказать сколько буханок нужно испечь на сегодня.
Есть несколько признаков

* погода по шкале от 1 до 5 
* праздник или выходной
* проходят ли сегодня спортивные игры

и вы знаете сколько буханок было продано в прошлом при разных признаках

A (5,1,0) = 300
B (3,1,1) = 255
C (1,1,0) = 75
D (4,0,1) = 200
E (4,0,0) = 150
F (2,0,0) = 50

Например сегодня выходной и хорошая погода

к = 4
(4,1,0) = ?
A 1
B 2
C 9
D 2
E 1
F 5

вычисляя среднее арифметическое продаж в эти дни вы получаете 218 буханок

Чтобы определить Степень сходства мы использовали формулу пифагора

Например два пользователя похожи но другой чуть более консервативен
если использовать формулу расстояния то два пользователя с одинаковыми
вкусами могут не оказаться соседями

Близость косинусов не измеряет расстояние между двумя векторами
Вместо этого она сравнивает углы двух векторов и в целом лучше 
подходит для подобных случаев

###Тема метрики косинусов TO DO

Выбор признаков

Очень важно правильно подобрать признаки для сравнения некоторые признаки
могут быть бесполезны в сравнении

Правильный выбор =

* признаки напрямую связанные с фильмами которые вы пытаетесь рекомендовать
* признаки не сожержащие смещения (если предлагать оценивать только комедии 
  вы не получите инфы о том как они относятся в боевикам)

есть еще хорошие признаки после которых можно повышать производительность

не существует правильного ответа о выборах хорошего признака. Нужно хорошо подумать
все факторы которые необходимо учесть при прогнозировании

* Машинное обучение
* OCR (optical character recognition)
* Распознование лиц и речи
* Построение спам фильтра (используется алгоритм наивный классификатор Баеса)
* Прогнозы на биржевых торгах (Прогноз будущего сложно машинное обучение не эффективно и при большом количестве переменных это почти не возможно)

Шпаргалка

* Алгоритм k ближайших соседей применяется для классификации и регресси 
  В нем используется проверка k ближайших соседей.
* «Извлечением признаков» называется преобразование элемента (на
  пример, фрукта или пользователя) в список чисел, которые могут ис
  пользоваться для сравнения.
  
* Качественный выбор признаков важная часть успешного алгоритма k ближайших соседей







